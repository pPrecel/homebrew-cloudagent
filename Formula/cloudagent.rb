# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Cloudagent < Formula
  desc "The simple and easy-to-use program designed to watch user activity for Cloud Providers."
  homepage "http://github.com/pPrecel/cloudagent"
  version "0.2.2"
  license "MIT"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/pPrecel/cloudagent/releases/download/v0.2.2/cloudagent_0.2.2_darwin_x86_64.tar.gz"
      sha256 "26817c03ad8ba09c77b7b6fa57fe12beaa6b15c225545afda070785794be7d4a"

      def install
        bin.install "cloudagent"
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/pPrecel/cloudagent/releases/download/v0.2.2/cloudagent_0.2.2_darwin_arm64.tar.gz"
      sha256 "1c865043b0de9df65c3acfb4b82efd2974a27027028c604c067ee9cc41eaf07b"

      def install
        bin.install "cloudagent"
      end
    end
  end

  on_linux do
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/pPrecel/cloudagent/releases/download/v0.2.2/cloudagent_0.2.2_linux_arm64.tar.gz"
      sha256 "1d97e42cf41e82bff5b60964276e39c11918c13ba848d9876d013e211d738ff6"

      def install
        bin.install "cloudagent"
      end
    end
    if Hardware::CPU.arm? && !Hardware::CPU.is_64_bit?
      url "https://github.com/pPrecel/cloudagent/releases/download/v0.2.2/cloudagent_0.2.2_linux_armv7.tar.gz"
      sha256 "e1ff2976e232e7b7c58e5650b8f9cd49fcbb34c3701c9462f8a71e53db69d8db"

      def install
        bin.install "cloudagent"
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/pPrecel/cloudagent/releases/download/v0.2.2/cloudagent_0.2.2_linux_x86_64.tar.gz"
      sha256 "86717b580f2fb8274defb28b4bb2e2b5321a80e8697a4a30684ac586e9165f24"

      def install
        bin.install "cloudagent"
      end
    end
  end

  plist_options :startup => false

  def plist; <<~EOS
    <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
  <dict>
    <key>EnvironmentVariables</key>
    <dict>
      <key>PATH</key>
      <string>/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:</string>
    </dict>
    <key>Label</key>
    <string>#{plist_name}</string>
    <key>ProgramArguments</key>
    <array>
      <string>#{opt_bin}/cloudagent</string>
      <string>serve</string>
    </array>
    <key>RunAtLoad</key>
    <true/>
    <key>KeepAlive</key>
    <true/>
    <key>StandardOutPath</key>
    <string>/tmp/cloudagent/cloudagent.stdout</string>
  </dict>
</plist>

  EOS
  end

  test do
    system "#{bin}/cloudagent"
  end
end
